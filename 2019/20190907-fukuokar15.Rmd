---
title: "Fukuoka.R#15でtidymodelsについての発表を行いました"
author: "Shinya Uryu"
date: "2019年9月7日"
output: 
  md_document:
    variant: markdown_github
---
```{r}
options(knitr.duplicate.label = TRUE)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, dpi = 300, fig.width = 6, fig.height = 5)
```

先週末（2019年8月31日）に開催された[Fukuoka.R#15](https://fukuoka-r.connpass.com/event/139211/) へ参加・発表してきました。Fukuoka.Rはその名の通り、九州・博多を中心として活動するRコミュニティです。私は茨城県つくば市に住んでいるので、会場のLINE Fukuokaまでは直線距離でおよそ928km離れた場所からの参加というわけです。いやはや遠い。遠いですが、参加してよかったと思える会でした。

以下、簡単にですが内容の振り返りと当日の発表では言えなかったことを書きます。

## 発表内容

「**tidymodelsによるモデル構築と運用**」という題での発表です。

[https://speakerdeck.com/s_uryu/tidymodels:embed:cite]

tidymodelsに含まれるパッケージについて言及した日本語を記事をしばしば見かけるようになりました。私自身もいくつか記事を書いています。

[https://blog.hoxo-m.com/entry/2019/06/08/220307:embed:cite]

[https://blog.hoxo-m.com/entry/2018/08/26/161144:embed:cite]


しかしtidymodelsの全容、包括的な話題を扱っている日本語の情報は限られています。そこで今回は、モデルの構築から運用に至るまでの手順をパッケージの利用方法とともに紹介する形式としました。具体的には`{rsample}`で対象データの分割、リサンプリング、`{recipes}`でデータ前処理、特徴量の用意、`{parsnip}`でのモデル実行、最後に`{yardstick}`による性能評価です。

スライド資料なので、言葉足らずな面があるかと思います。
テキストと合わせた内容は id:dropout009 さんの記事 ([その1](https://dropout009.hatenablog.com/entry/2019/01/06/124932),[その2](https://dropout009.hatenablog.com/entry/2019/01/09/214233))を読んでおけばOKかなと感じる部分もあります。資料作成時も大変参考となりました。

今回は30分の枠でした。Tokyo.Rでは20分の枠が一般的なのでちょっと長めですね。たっぷりと話すことができました（その分詰め込みすぎて余裕がなくなってしまったという本末転倒な反省も）。tidymodelsはパイプフレンドリーで関数や操作性に一貫性があり、またパッケージがタスクに応じて分割されているので紹介もしやすかったです。

## 発表から除外したもの

最後の方は説明が複雑になる、時間も足りないということもあり、駆け足で説明不足になってしまいました。また、運用をタイトルに入れていたので`{drake}`、`{butcher}`の紹介をと考えていましたが明らかに時間が足りない、それよりは他の説明に時間を割こうとして除外しました。そのため、こちらで簡単に補足させていただきます。

`{drake}`はtidymodelsの支配下にないパッケージであり、モデルとは関係しません。しかしモデル構築の作業をワークフロー化することで、再現性を確保、手間を減らすことが期待できます。おすすめです。

[https://blog.hoxo-m.com/entry/2018/09/05/184425:embed:cite]



また当初、[`{butcher}`](https://tidymodels.github.io/butcher/)を組みこもうとしていましたが結局除外してしまいました。このパッケージはモデルオブジェクトのサイズを減少させるのに効果的です。というのもモデル構築の過程でオブジェクトサイズが増大することがあるためです。関数の環境内で余分なオブジェクトを生成しているとそれが影響する感じでしょうか（よくわかっていない部分があります…）。`{butcher}`パッケージの名前は肉屋の従業員。その名の通り、余分なデータを捌きます。{butcher}を利用すると先のオブジェクトサイズが減少します。やや物騒な名前の関数を使います。こちらは`{parsnip}`が対応するエンジンについて対応しており、すでにCRANに登録されています。

今回のテーマはtidymodelsでしたが、今Rで機械学習モデルを実行するには他の選択肢がいくつかあります。この比較についても発表時は行えませんでした。以前tweetで発信した情報がありますのでこちらをご覧ください。


## その他雑感

およそ1月前に参加申し込みをしたので時間はあったのですが、なかなか構想をまとめることができずに資料作成に着手するのが遅くなってしまいました。これによって、だいたい毎度のことですが練習が足りていない状態での発表となってしまいました。反省です。

しかし今回は資料の作成に費やす時間がいつもより少なかったです。それは過去資料の使い回しやテンプレートの導入が活きたためだと思います（例えば導入部分はこちらの資料からのコピー）。この辺は、発表のたびにスタイルに手直しを入れたり、新しいものを取り入れたいという欲望と上手くバランスを取れたかなと。

次回どこかで発表する時のために、資料を作っておこうと思いましたまる。

また、国内のRコミュニティへの参加は、Tokyo.Rと運営に関わるTsukuba.Rを除いて2つ目でした（最初はOsaka.Rです）。熱気のある街、博多と同じく、Fukuoka.Rも熱のある人が多く感じました。福岡だけでなく、九州各地、自分のように遠方からの参加者も多くいたのが印象にあります。





Enjoy!

